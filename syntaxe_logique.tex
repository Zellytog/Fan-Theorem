\subsection{HOL Model}

We fix a family of sorts including integers, booleans, lists of a given sort, functions and products. We also add propositions, so that our model is HOL-like.

\begin{definition}[Sorts]
  We define the set of sorts $\Sort$ inductively by:
  \[S,T \Coloneq \Nat \mid \Bool \mid \List(S)\mid S \times T \mid S \to T \mid \Prop\]
\end{definition}

To define terms, we first define HOL-contexts.

\begin{definition}[HOL-context]
  We fix a denumerable set $\Xt$ of variables which we denote by $\varx,\vary,\ldots$ A (HOL-)context is a list of pairs $(\varx : S)$ where $\varx \in \Xt$ and $S \in \Sort$. We denote the set of (HOL-)contexts by $\Hctx$ and will write its elements $\Gamma,\Delta,\ldots$
\end{definition}

\begin{definition}[HOL-terms]
  A well-typed (HOL-)term in a context $\Gamma$ is defined by the following inductive relation:
  \begin{center}
  \AxiomC{$(\varx : S) \in \Gamma$}
  \UnaryInfC{$\Gamma \vdash \varx : S$}
  \DisplayProof
  \qquad
  \AxiomC{$\Gamma, \varx : S \vdash \termt : T$}
  \UnaryInfC{$\Gamma\vdash \termlam \varx. \termt : S \to T$}
  \DisplayProof
  \qquad
  \AxiomC{$\Gamma \vdash \termt : S \to T$}
  \AxiomC{$\Gamma \vdash \termu : S$}
  \BinaryInfC{$\Gamma\vdash \termt(\termu) : T$}
  \DisplayProof
  
  \vspace{0.2cm}
  \AxiomC{$\Gamma \vdash \termt : S$}
  \AxiomC{$\Gamma\vdash \termu : T$}
  \BinaryInfC{$\Gamma \vdash \langle \termt, \termu \rangle : S \times T$}
  \DisplayProof
  \qquad
  \AxiomC{$\Gamma\vdash \termt : S \times T$}
  \UnaryInfC{$\Gamma\vdash \termpi_1(\termt) : S$}
  \DisplayProof
  \qquad
  \AxiomC{$\Gamma\vdash \termt : S \times T$}
  \UnaryInfC{$\Gamma\vdash \termpi_2(\termt) : T$}
  \DisplayProof

  \vspace{0.2cm}
  \AxiomC{}
  \UnaryInfC{$\Gamma\vdash \termZ : \Nat$}
  \DisplayProof
  \qquad
  \AxiomC{$\Gamma\vdash \termt : \Nat$}
  \UnaryInfC{$\Gamma\vdash \termS(\termt) : \Nat$}
  \DisplayProof

  \vspace{0.2cm}
  \AxiomC{$\Gamma\vdash \termt : S$}
  \AxiomC{$\Gamma\vdash \termu : \Nat \to S \to S$}
  \AxiomC{$\Gamma\vdash \termv : \Nat$}
  \TrinaryInfC{$\Gamma\vdash \termrec_{\Nat}(\termt,\termu,\termv) : S$}
  \DisplayProof

  \vspace{0.2cm}
  \AxiomC{}
  \UnaryInfC{$\Gamma\vdash \termtt : \Bool$}
  \DisplayProof
  \qquad
  \AxiomC{}
  \UnaryInfC{$\Gamma\vdash \termff : \Bool$}
  \DisplayProof

  \vspace{0.2cm}
  \AxiomC{$\Gamma\vdash \termt : S$}
  \AxiomC{$\Gamma\vdash \termu : S$}
  \AxiomC{$\Gamma\vdash \termv : \Bool$}
  \TrinaryInfC{$\Gamma\vdash \termrec_{\Bool}(\termt,\termu,\termv) : S$}
  \DisplayProof

  \vspace{0.2cm}
  \AxiomC{}
  \UnaryInfC{$\Gamma\vdash \termnil : \List(S)$}
  \DisplayProof
  \qquad
  \AxiomC{$\Gamma\vdash \termt : S$}
  \AxiomC{$\Gamma\vdash \termu : \List(S)$}
  \BinaryInfC{$\Gamma\vdash \termt\termcons\termu : \List(S)$}
  \DisplayProof

  \vspace{0.2cm}
  \AxiomC{$\Gamma\vdash \termt : T$}
  \AxiomC{$\Gamma\vdash \termu : S \to \List(S) \to T \to T$}
  \AxiomC{$\Gamma\vdash \termv : \List(S)$}
  \TrinaryInfC{$\Gamma\vdash \termrec_{\List(S)}(\termt,\termu,\termv) : T$}
  \DisplayProof

  \vspace{0.2cm}
  \AxiomC{$\Gamma\vdash \varphi : \Prop$}
  \AxiomC{$\Gamma\vdash \psi : \Prop$}
  \BinaryInfC{$\Gamma\vdash \varphi \to \psi : \Prop$}
  \DisplayProof
  \qquad
  \AxiomC{$\Gamma, \varx : S \vdash \varphi : \Prop$}
  \UnaryInfC{$\Gamma\vdash \forall \varx^S, \varphi : \Prop$}
  \DisplayProof

  \vspace{0.2cm}
  \AxiomC{$\Gamma\vdash : \termt : S$}
  \UnaryInfC{$\Gamma \vdash S(\termt) : \Prop$}
  \DisplayProof
  \end{center}
\end{definition}

We now give the natural set-semantic for each sort and term, parametrized by a complete Heyting algebra $H$ representing $\Prop$.

\begin{definition}[Semantic]
  Let $(H,\leqH)$ be a Heyting algebra with an intersection operation.
  For each sort $S \in \Sort$, we associate a set $\sem S$:
  \begin{itemize}
  \item $\sem{\Nat} \defeq \bN$
  \item $\sem{\Bool} \defeq \bB$
  \item $\sem{\List(S)} \defeq \sem S ^\star$
  \item $\sem{S \times T} \defeq \sem S \times_{\Set} \sem T$
  \item $\sem{S \to T} \defeq {\sem T}^{\sem S}$
  \item $\sem{\Prop} \defeq H$
  \end{itemize}

  Let
  \[\begin{array}{ccccc}
  \cod - &:& \bigcup_{S \in \Sort} \sem{S} & \longrightarrow & H \\
  & & s &\longmapsto & \cod s
  \end{array}\]
  be a function associating to each object a set of codes (possibly empty).

  Each well-typed term $\Gamma \vdash \termt : S$ is mapped to its semantic
  \[
  \sem{\Gamma \vdash \termt : S} : \prod_{T \in \Gamma} \sem T \longrightarrow \sem S
  \]
  by the following interpretation:
  \begin{itemize}
  \item $\sem{\varx_1 : S_1,\cdots , \varx_n : S_n\vdash \varx_i : S_i} \defeq \pi_i^n$
  \item
    \begin{multline*}
      \sem{\Gamma \vdash \termlam \varx.\termt : S \to T} \defeq \\
      (x \in \sem S) \mapsto (\overrightarrow{x} \in \sem \Gamma) \mapsto \sem{\Gamma, \varx : S\vdash \termt : T}(\overrightarrow{x},x)
    \end{multline*}
  \item $\sem{\Gamma\vdash \termt(\termu) : T} \defeq \eval\circ \langle\sem{\Gamma\vdash \termt : S \to T}, \sem{\Gamma\vdash \termu : S}\rangle$
  \item $\sem{\Gamma\vdash \langle \termt,\termu\rangle : S \times T} \defeq \langle \sem{\Gamma\vdash \termt : S}, \sem{\Gamma\vdash \termu : T}\rangle$
  \item $\sem{\Gamma\vdash \termpi_1(\termt) : S} \defeq \pi_1 \circ \sem{\Gamma\vdash \termt : S \times T}$
  \item $\sem{\Gamma\vdash \termpi_2(\termt) : S} \defeq \pi_2 \circ \sem{\Gamma\vdash \termt : S \times T}$
  \item $\sem{\Gamma\vdash \termZ : \Nat} \defeq (\overrightarrow{x} \in \sem\Gamma) \mapsto 0$
  \item $\sem{\Gamma\vdash \termS(\termt) : \Nat} \defeq (n \mapsto n + 1) \circ \sem{\Gamma\vdash \termt : \Nat}$
  \item
    \begin{multline*}
      \sem{\Gamma\vdash \termrec_{\Nat}(\termt,\termu,\termv) : S} \defeq \\
      \rec_{\bN}(\sem{\Gamma\vdash \termt : S}, \sem{\Gamma\vdash \termu : \Nat \to S \to S}, \sem{\Gamma\vdash \termv : \Nat})
    \end{multline*}
  \item $\sem{\Gamma\vdash \termtt : \Bool} \defeq (\overrightarrow x \in \sem{\Gamma}) \mapsto \top$
  \item $\sem{\Gamma\vdash \termff : \Bool} \defeq (\overrightarrow x \in \sem{\Gamma}) \mapsto \bot$
  \item
    \begin{multline*}
      \sem{\Gamma\vdash \rec_{\Bool}(\termt,\termu,\termv) : S} \defeq \\
      \rec_{\bB}(\sem{\Gamma\vdash \termt : S}, \sem{\Gamma\vdash \termu : S}, \sem{\Gamma\vdash \termv : \Bool})
    \end{multline*}
  \item $\sem{\Gamma\vdash \termnil : \List(S)} \defeq (\overrightarrow x \in \sem{\Gamma}) \mapsto \varepsilon$
  \item $\sem{\Gamma\vdash \termt \termcons \termu : \List(S)}\defeq \smallfrown \circ \langle\sem{\Gamma\vdash \termt : \List(S)},\sem{\Gamma\vdash\termu : S}\rangle$
  \item
    \begin{multline*}
      \sem{\Gamma\vdash\rec_{\List(S)}(\termt,\termu,\termv) : T} \defeq\\
      \rec_{\bL}(\sem{\Gamma\vdash \termt : T}, \sem{\Gamma\vdash \termu : S \to \List(S) \to T \to T}, \sem{\Gamma\vdash \termv : \List(S)})
    \end{multline*}
  \item $\sem{\Gamma\vdash \varphi \to \psi : \Prop} \defeq \sem{\Gamma\vdash \varphi : \Prop}\implH \sem{\Gamma\vdash \psi : \Prop}$
  \item $\displaystyle\sem{\Gamma\vdash \forall \varx^S, \varphi : \Prop} \defeq (\overrightarrow x \in \sem{\Gamma}) \mapsto \bigcap_{s \in \sem S} \sem{\Gamma, \varx : S\vdash \varphi : \Prop}(\overrightarrow x, s)$
  \item $\sem{\Gamma\vdash S(\termt) : \Prop} \defeq \cod - \circ \sem{\Gamma\vdash \termt : S}$
  \end{itemize}
  where $\rec_{\bN}$ (resp. $\rec_{\bB}$, resp. $\rec_{\bL}$) are the canonical recurcors given by the initial algebra structure of $\bN$ (resp. $\bB$, resp. $\sem S^\star$), $\smallfrown$ is the operation which, given a letter $a$ and a word $u$, appends $a$ to $u$ to make a new word, $\implH$ is the implication of $H$, and $\bigcap$ is its intersection.

  For a given sort $S$, we will also write $\bS$ for $\sem S$.
\end{definition}

\begin{notation}
  Given a HOL-context $\Gamma$ and a function $\displaystyle\termenv : \Xt \partialto \bigcup_{S \in \Sort} \bS$, we define
  \[\termenv\models \Gamma \defeq \forall (\varx : S) \in \Gamma, \termenv(\varx) \in \bS\]
  If $\Gamma \vdash \termt : S$ and $\termenv\models \Gamma$, then we write $\termenv(\termt)$ for the canonical element in $\bS$ associatied to this term.
\end{notation}
